(()=>{var e={};e.id=665,e.ids=[665],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6385:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d}),t(8391),t(5866),t(1506);var s=t(3191),o=t(8716),n=t(7922),a=t.n(n),i=t(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(r,l);let d=["",{children:["(auth)",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8391)),"C:\\Users\\Bron\\projects\\LJ-s-tutoring\\web\\app\\(auth)\\login\\page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"C:\\Users\\Bron\\projects\\LJ-s-tutoring\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\Bron\\projects\\LJ-s-tutoring\\web\\app\\(auth)\\login\\page.tsx"],c="/(auth)/login/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/(auth)/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4958:()=>{},3270:(e,r,t)=>{Promise.resolve().then(t.bind(t,2175))},870:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},2175:(e,r,t)=>{"use strict";t.d(r,{LoginForm:()=>a});var s=t(326),o=t(7577),n=t(7389);function a(){let e=(0,n.useRouter)(),r=(0,n.useSearchParams)(),[t,a]=(0,o.useState)(""),[i,l]=(0,o.useState)(""),[d,u]=(0,o.useState)(!1),[c,p]=(0,o.useState)(null);async function m(s){s.preventDefault(),u(!0),p(null);try{let s=await fetch("/api/auth/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:t,password:i})}),o=await s.json().catch(()=>({}));if(!s.ok){p(o.error??"Unable to sign in. Please try again.");return}let n=r.get("next");if(n&&n.startsWith("/")){e.replace(n),e.refresh();return}if(o.redirectTo?.startsWith("http://")||o.redirectTo?.startsWith("https://")){window.location.assign(o.redirectTo);return}"STUDENT"===o.role?e.replace("/dashboard"):"TUTOR"===o.role?e.replace("/tutor/dashboard"):"ADMIN"===o.role?e.replace("/admin"):o.redirectTo?.startsWith("/")?e.replace(o.redirectTo):e.replace("/dashboard"),e.refresh()}catch{p("Network error. Please try again.")}finally{u(!1)}}return(0,s.jsxs)("form",{className:"ody-card space-y-4",onSubmit:m,children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Sign in"}),s.jsx("p",{className:"text-sm text-ody-muted",children:"Use your existing Odysseus credentials. Session is stored in HttpOnly cookies."}),c&&s.jsx("p",{className:"rounded-lg border border-rose-400/40 bg-rose-500/10 px-3 py-2 text-sm text-rose-200",children:c}),(0,s.jsxs)("label",{className:"grid gap-1 text-sm",children:["Email",s.jsx("input",{name:"email",type:"email",required:!0,autoComplete:"email",value:t,onChange:e=>a(e.target.value),className:"rounded-lg border border-ody-border bg-slate-900/50 px-3 py-2"})]}),(0,s.jsxs)("label",{className:"grid gap-1 text-sm",children:["Password",s.jsx("input",{name:"password",type:"password",required:!0,autoComplete:"current-password",value:i,onChange:e=>l(e.target.value),className:"rounded-lg border border-ody-border bg-slate-900/50 px-3 py-2"})]}),s.jsx("button",{className:"ody-btn-primary w-full",type:"submit",disabled:d,children:d?"Signing inâ€¦":"Sign in"})]})}},8391:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(9510),o=t(8585),n=t(1023);let a=(0,t(8570).createProxy)(String.raw`C:\Users\Bron\projects\LJ-s-tutoring\web\components\app\login-form.tsx#LoginForm`);async function i(){let e=await (0,n.G)();return e?.user?.role==="TUTOR"&&(0,o.redirect)("/tutor/dashboard"),e?.user?.role==="STUDENT"&&(0,o.redirect)("/dashboard"),e?.user?.role==="ADMIN"&&(0,o.redirect)("/admin"),s.jsx("main",{className:"mx-auto max-w-md px-6 py-16",children:s.jsx(a,{})})}},1506:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n,metadata:()=>o});var s=t(9510);t(7272);let o={title:"Project Odysseus | Academic OS",description:"Unified Next.js migration for Project Odysseus"};function n({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{children:e})})}},1964:(e,r,t)=>{"use strict";function s(e){for(let r of e){let e=process.env[r];if(e)return e}return""}t.d(r,{C:()=>o});let o=(function(e){let r=s(e);if(!r)throw Error(`Missing required env var. Provide one of: ${e.join(", ")}`);return r})(["API_BASE_URL","PUBLIC_PO_API_BASE","NEXT_PUBLIC_API_BASE_URL"]).replace(/\/$/,"");s(["NEXT_PUBLIC_API_BASE_URL","PUBLIC_PO_API_BASE","API_BASE_URL"]).replace(/\/$/,"")},1023:(e,r,t)=>{"use strict";t.d(r,{G:()=>i,o:()=>l});var s=t(1615),o=t(8585),n=t(1159),a=t(1964);let i=(0,n.cache)(async()=>{let e=(0,s.cookies)().getAll().map(e=>`${e.name}=${e.value}`).join("; ");if(!e.includes("session="))return null;let r=await fetch(`${a.C}/auth/session`,{method:"GET",headers:{cookie:e},cache:"no-store"});return r.ok?await r.json():null});async function l(e){let r=await i();return r||(0,o.redirect)("/login"),e&&!e.includes(r.user.role)&&("TUTOR"===r.user.role&&(0,o.redirect)("/tutor/dashboard"),"STUDENT"===r.user.role&&(0,o.redirect)("/dashboard"),(0,o.redirect)("/login")),r}},7272:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,471,54],()=>t(6385));module.exports=s})();